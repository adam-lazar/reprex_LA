<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Antal">
<meta name="dcterms.date" content="2023-12-06">
<meta name="keywords" content="Observatory">

<title>Automated Data Observatory</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="observatory-replication_files/libs/clipboard/clipboard.min.js"></script>
<script src="observatory-replication_files/libs/quarto-html/quarto.js"></script>
<script src="observatory-replication_files/libs/quarto-html/popper.min.js"></script>
<script src="observatory-replication_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="observatory-replication_files/libs/quarto-html/anchor.min.js"></script>
<link href="observatory-replication_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="observatory-replication_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="observatory-replication_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="observatory-replication_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="observatory-replication_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #00348A;
      }
</style>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Automated Data Observatory</h1>
            <p class="subtitle lead">An open call to build better data spaces, observatories, or make existing data programs futureproof</p>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://reprex.nl/author/daniel-antal/">Daniel Antal</a> <a href="https://orcid.org/0000-0001-7513-6760" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Reprex
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">6 December 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#opendata" id="toc-opendata" class="nav-link active" data-scroll-target="#opendata">Embrace the future of open data</a></li>
  <li><a href="#join-the-digital-music-observatory" id="toc-join-the-digital-music-observatory" class="nav-link" data-scroll-target="#join-the-digital-music-observatory">Join the Digital Music Observatory</a></li>
  <li><a href="#horizon" id="toc-horizon" class="nav-link" data-scroll-target="#horizon">Automated Research Data Management Task (Domain Agnostic)</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="observatory-replication.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="observatory-replication.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="observatory-replication.epub"><i class="bi bi-file"></i>ePub</a></li></ul></div></nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><code>Reprex</code> is a Dutch startup that grew out of the prestigious <code>Yes!Delft AI+Blockchain Lab</code> where we have validated our <code>automated data observatory</code> concept. In Creative Europe’s <em>JUMP European Music Market Accelerator</em>, we applied our idea to our beachhead market, music, where the European Commission was already planning to launch a new observatory. In 2022, we won a Horizon Europe Research and Innovation Action grant to build a prototype of a European music observatory; in 2023, our platform has been hosting several Music Moves Europe <em>MusicAIRE</em> projects.</p>
<p>Our product is a 2020s reimagination of the data <strong>observatory</strong> concept. Historically, it has been a location used for observing terrestrial, marine, or celestial events. In the last 30 years, many social, humanities, and economic observatories have been established to provide a consistent and permanent data and knowledge recording point; we have not found anyone with significant research automation capacity or who deploys trustworthy AI. Our partners can deploy a new observatory or refurbish an existing one that offers higher data quality, better data ecosystem growth, lower data collection costs and more modern services than existing observatories.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="png/observatory_collage_16x9_800.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Various UN and OECD bodies, and particularly the European Union support or maintain more than 60 data observatories, or permanent data collection and dissemination points. They are often financed from the Horizon Europe programme.</figcaption>
</figure>
</div>
<p>About 3-5 new observatories go functional every year, and 1-2 become discontinued. Their services, data quality and quantity vary; however, in more than 95% of the cases, they receive significant public funding. They offer benefits for all parties in the knowledge triangle: academia, civil society, and innovative business. We want to bring the creation of a new observatory more affordable to our research and innovation partners and use this opportunity to introduce them to further reproducible research applications that can significantly increase the competitiveness and impact of their business processes in scientific, policy or business research.</p>
<div style="page-break-after: always;"></div>
<section id="opendata" class="level2">
<h2 class="anchored" data-anchor-id="opendata">Embrace the future of open data</h2>
<ul>
<li><p><strong>Semantic web technologies</strong> for exponentially increasing return on data investments: we organise our partner’s data collection with data linking technology that enables a decentralised, secure, and inexpensive way to integrate small domain-specific databases into a big data space.</p></li>
<li><p><strong>Taking the most out of open data</strong>: we are creating and continuously improving an R language software ecosystem that re-processes hard-to-use open data, such as data from environmental satellites, microdata repositories of survey archives and statistical providers, anonymised government data into statistical quality datasets, as if they came from the Eurostat website–because we use the same statistical production principles as statistical authorities. <em>See our blogpost</em> <a href="https://music.dataobservatory.eu/post/2021-06-18-gold-without-rush/">Open Data - The New Gold Without the Rush</a>.</p></li>
<li><p><strong>Statistical innovation for exchanging privately held and governmental statistical microdata</strong>, following the recent best practices approved by the UN and EU statistical bodies for experimental big data statistical products. <em>Check out our <a href="https://music.dataobservatory.eu/documents/open_music_europe/slovakia/slovak-cult-stat-pilot.html">pilot program in Slovakia</a>, which aims to be the first in-production application of the recent UN/Eurostat innovation of combining privately held data with official statistical production in the cultural and creative sectors. We aim to renew the satellite accounts of the Slovak Republic with a music and film account and show how privately-held registers and accounts can be safely coordinated with official statistical registers and survey frames <span class="citation" data-cites="slovak-cult-stat-pilot">(<a href="#ref-slovak-cult-stat-pilot" role="doc-biblioref">Antal 2023</a>)</span>.</em></p></li>
<li><p><strong>Taking open science a step further</strong> than the five-star recommendations of the Horizon Europe program: our observatories optimise data dissemination and place your deliverables directly into global library systems and global repositories. Our observatories are equipped with journal/book publishing automated workflows and can publish reports and yearbooks at ease. We also measure your impact and prove that we take it further than anything you have seen.</p></li>
<li><p><strong>Open Policy Analysis Guidelines</strong>: we are the first adopters of the OPA Guidelines, originally developed at Berkeley to adopt open science transparency criteria for evidence-based policy research. The advantage of OPA is greater visibility and, quicker policy impact, and better stakeholder engagement.</p></li>
<li><p><strong>Better data governance and stewardship</strong>: our observatory concept was developed over a decade to resolve the problems of connecting valuable private music datasets with conflicting interests and cutting through the boundaries of legal entities and countries. See you at 18th edition of IDCC24, the <em>International Digital Curation Conference (IDCC24), where we will present our in a global conference</em>.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="png/MoU_signing.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">In March, the project signed <em>Memorandum of Understanding on utilizing the Open Policy Analysis results of the OpenMuse Research and Innovation Consortium in the context of Slovak cultural and creative industries and sectors’ public policies</em> <span class="citation" data-cites="open_music_europe_sk_mou_2023">(<a href="#ref-open_music_europe_sk_mou_2023" role="doc-biblioref">Ministerstvo kultúry SR and Open Music Europe 2023</a>)</span> with the Slovak Ministry of Culture to form an open policy collaboration based on the OPA Guidelines. This MoU allowed us to initiate a series of ongoing policy stakeholder consultations in the Slovak Republic with an increasing number of relevant bodies, providing very clear exploitation pathways (in the policy field) and maximising potential policy impact.</figcaption>
</figure>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="join-the-digital-music-observatory" class="level2">
<h2 class="anchored" data-anchor-id="join-the-digital-music-observatory">Join the Digital Music Observatory</h2>
<div style="page-break-after: always;"></div>
<p>The <code>Digital Music Observatory</code> is a prototype of an open, decentralised, reproducible research-supported data observatory that follows the <em>Feasibility Study for establishing a European Music Observatory</em>. High-quality indicators and databases are being developed, consulted with the industry, produced and added to the Digital Music Observatory web resource in various public and private projects. The platform is being developed by Reprex, and the four main Data Pillars by the <a href="https://openmuse.eu/">Open Music Europe</a> project. It’s offspring, <a href="https://opencollections.net/">Open Collections</a> is geared towards GLAM (galleries, libraries, archives, museums) and works with microdata, such as inventory books, catalogues, survey databases.</p>
<ul>
<li><p>For <code>policy researchers</code>, we can provide high-quality indicators that cannot be found elsewhere. Our statistical production workflow and quality assurance are similar to those of the European Statistics Code of Practice and the Quality Assurance Framework of the European Statistical System (with necessary modifications and simplification as we do open statistics and we are not part of any member state’s statistical authority.) <a href="https://music.dataobservatory.eu/services/public-policy/">More ⏩</a></p></li>
<li><p>For <code>music businesses</code> and their national organisations, music information centers, libraries we provide software-as-service solutions to improve your datasets and databases. We also welcome case studies in Creative Europe or Horizon Europe projects. <a href="https://music.dataobservatory.eu/services/business-institution/">More ⏩</a></p></li>
<li><p>For <code>academic researchers</code>, we provide data and a publishing platform where your research (already from a blogpost or working paper stage) receive higher visibility and impact than it normally would. If you are not supported by a university press publisher, we provide you all the infrastructure, DOI and ISBN identifiers to make your work visible in global repositories, library catalogues, and even place your work in libraries. <a href="https://music.dataobservatory.eu/services/researchers/">More ⏩</a></p></li>
<li><p>For <code>data curators and stewards</code> we provide best practices for research data management and data stewardship. Our entire music observatory is ready for replication, and we are already working on a <code>Global Green Film Observatory</code> and a <code>Global Pollinators Observatory</code> to place our data-to-policy pipeline, research automation tools and data infrastructure into new domains and contexts. We can provide your projects and organisations with the best available research data management, measured impacts, and complete digital publishing solutions. Our automated data observatory can provide your project <em>Data Management Plan</em> with a DCAT-API standard data catalogue (ready to be published on the European Open Data Portal, far beyond the requirements of Horizon Europe or national data management requirements), or we can take over the entire data stewardship of your project and manage your DMP from the onset of the project. (Current requirement is from the 3rd month of the project, and in some cases, from day 1.) <a href="https://music.dataobservatory.eu/services/data-knowledge/">More ⏩</a></p></li>
</ul>
<p>If you want to use the <code>Digital Music Observatory</code> as a digital dissemination platform, a data resource, a publishing resource, a knowledge center for your project, please <a href="https://music.dataobservatory.eu/documents/Join_DMO_Stakeholder_Network.html">join our stakeholder network</a>.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="horizon" class="level2">
<h2 class="anchored" data-anchor-id="horizon">Automated Research Data Management Task (Domain Agnostic)</h2>
<p>Our <code>automated data observatory</code> is itself a reproducible service that can power a data space or a data observatory. It is equipped with various reproducible research, digital publishing and knowledge engineering tools that can enrich any existing data collaborations or PPPs or jump-start a new one. If you start new research projects, our technology is ideal for creating a meaningfully higher impact with your research data management.</p>
<p>Our product is being developed in itself in a Horizon Europe project based on our minimal viable product validated in the <em>Yes!Delft AI+Blockchain Lab Product/Market Fit</em> and the <em>JUMP</em> European accelerator program. As it is built from open-source components (mainly developed by Reprex and its data science partners), its various components are on TLR Levels 4-8.</p>
<ul>
<li><p>Curate and reconcile ontologies, taxonomies, and shared authority control files, to collect, enrich and integrate data from heterogeneous knowledge sources (for example, the European Environmental Agency data warehouse, the Copernicus data warehouse, primary survey sources.)</p></li>
<li><p>Beyond the state-of-the-art harvesting data from ecological and socio-economic data sources, with BeeSage, we create a knowledge model to incorporate data collected from potentially hundreds of Research Hives, thus using actual beehives and their <code>Digital Hive Twins</code> as part of a cloud-based research infrastructure that is compatible with satellite surveyance of the area of the beehives, the meteorological, hydrological and socio-economic data collections of the immediate neighbourhood of them. For example, we package the data of the ResearchHives from <code>North Friesland</code> a small statistical region with business data, survey data from the same area; North Frieslands’s meteorological, hydrological, and pollution data; and satellite images of leaf coverage and other essential indicators overlaying the <code>North Friesland</code> NUTS3 area.</p></li>
<li><p>Use our data-to-policy pipeline and R software packages to create tidy datasets in a data catalogue for internal use in the consortium and for reuse. On tidy datasets, we mean W3C standard, future-proof datasets that are optimised to be imported into relational and graph databases (for repeating or semantic applications) and, as stand-alone datasets, can be opened in spreadsheet or statistical software packages without further data wrangling. By a data catalogue, we mean an internal consortium data catalogue following the DCAT-API application standard of the European Open Data Portal and Eurostat.</p></li>
<li><p>Use our dissemination model to ensure that all public datasets, documents, figures immediately find their way directly to the Open Data Portal, and in the OpenAIRE and other relevant open science repositories, and into various library catalogues globally. Our digital data distribution boosts the scientific and community outreach of the consortium.</p></li>
<li><p>For Consortium partners not supported by a University Press publisher, we provide a <code>Your Observatory</code> ISBN and DOI identifiers for all public deliverables for maximum scientific impact and findability. (Read, for example, 2 pages on the <code>Global Pollinator Observatory</code>: <a href="https://reprex.nl/documents/pollinators/BeeSage_Reprex_Horizon_Europe_for_universities.pdf">pdf</a> )</p></li>
<li><p>Reprex’s automated data observatory components, including a peer-reviewed and functional open-source survey data harmonisation software and environmental and ecological impact assessment software, are on TLR Levels 7-9. A new observatory must be partly defined during the proposal writing process by the researchers and partially delivered in the early stage of the project. Overall, Reprex has a proven technology to provide a research infrastructure, with many elements ready to be deployed in days. However, new research functionality must be defined and added, so a new observatory can be placed to TLR Level 3 or 4 which is ideal for Horizon Europe or Creative Europe Innovation Lab funding.</p></li>
</ul>
<p>If you already have a task for Research Data Management, our task can contribute to this task with a standardised data catalogue that fulfils the requirements set by the Horizon Europe program and the EU Open Data Portal in the EU Publications Office. If you do not already have such a task assigned, our task can create your project’s mandatory, five-star, human-readable and machine-actionable data management plan.</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-slovak-cult-stat-pilot" class="csl-entry" role="listitem">
Antal, Daniel. 2023. <span>‘<span class="nocase">Pilot Program for Novel Music Industry Statistical Indicators in the Slovak Republic</span>’</span>. Zenodo. <a href="https://doi.org/10.5281/zenodo.8399254">https://doi.org/10.5281/zenodo.8399254</a>.
</div>
<div id="ref-open_music_europe_sk_mou_2023" class="csl-entry" role="listitem">
Ministerstvo kultúry SR, and Open Music Europe. 2023. <span>‘<span>Memorandum o porozumení o využití výsledkov analýz otvorených politík v kontexte slovenského kultúrneho a kreatívneho priemyslu a sektorových verejných politík v spolupráci s konzorciom pre výskum a inovácie s názvom OpenMuse. [Memorandum of Understanding on utilizing the Open Policy Analysis results of the OpenMuse Research and Innovation Consortium in the context of Slovak cultural and creative industries and sectors’ public policies]</span>’</span>. <a href="https://www.crz.gov.sk/zmluva/7645338/">https://www.crz.gov.sk/zmluva/7645338/</a>.
</div>
<div id="ref-openmuse_2023" class="csl-entry" role="listitem">
Open Music Europe. 2023. <span>‘<span class="nocase">Open Music Europe (OpenMusE) – An Open, Scalable, Data-to-Policy Pipeline for European Music Ecosystems</span>’</span>. <a href="https://doi.org/10.3030/101095295">https://doi.org/10.3030/101095295</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>